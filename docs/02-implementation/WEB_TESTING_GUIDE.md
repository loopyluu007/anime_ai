# Web端测试指南

> **最后更新**: 2026-01-12  
> **状态**: 测试指南

---

## 📋 测试概述

本文档提供Web端应用的测试指南，包括功能测试、兼容性测试和性能测试。

---

## 🚀 快速开始

### 1. 启动Web应用

```bash
# 确保在项目根目录
cd /path/to/anime_ai

# 运行Web应用
flutter run -d chrome

# 或者指定端口
flutter run -d chrome --web-port=8080
```

### 2. 构建Web应用

```bash
# 构建Web应用（开发模式）
flutter build web

# 构建Web应用（发布模式，优化）
flutter build web --release

# 构建后的文件在 build/web/ 目录
```

### 3. 本地测试构建结果

```bash
# 使用Python简单HTTP服务器
cd build/web
python -m http.server 8080

# 或使用Node.js http-server
npx http-server -p 8080
```

---

## ✅ 功能测试清单

### 认证功能

- [ ] **用户注册**
  - 输入用户名、邮箱、密码
  - 验证表单验证
  - 检查错误提示
  - 验证注册成功后自动登录

- [ ] **用户登录**
  - 输入邮箱和密码
  - 验证Token存储
  - 检查登录状态保持
  - 验证自动登录功能

- [ ] **登出功能**
  - 点击登出按钮
  - 验证Token清除
  - 检查重定向到登录页

### 对话功能

- [ ] **对话列表**
  - 显示对话列表
  - 验证分页加载
  - 检查空状态显示
  - 测试对话创建

- [ ] **聊天界面**
  - 发送消息
  - 接收消息
  - 验证消息显示
  - 检查WebSocket连接
  - 测试消息重试

### 任务功能

- [ ] **任务列表**
  - 显示任务列表
  - 验证任务状态
  - 检查任务筛选
  - 测试任务创建

- [ ] **任务详情**
  - 显示任务详情
  - 验证进度更新
  - 检查WebSocket实时推送
  - 测试任务取消

### 剧本功能

- [ ] **剧本生成**
  - 创建新剧本
  - 验证剧本草稿生成
  - 检查剧本确认
  - 测试剧本更新

- [ ] **剧本预览**
  - 显示剧本内容
  - 验证分镜展示
  - 检查图片/视频显示
  - 测试剧本下载

### 媒体功能

- [ ] **图片生成**
  - 触发图片生成
  - 验证生成进度
  - 检查图片显示
  - 测试图片下载

- [ ] **视频生成**
  - 触发视频生成
  - 验证生成进度
  - 检查视频播放
  - 测试视频下载

  - 选择多个视频
  - 触发合并操作
  - 验证合并进度
  - 检查合并结果

### 设置功能

- [ ] **用户设置**
  - 修改用户信息
  - 验证信息保存
  - 检查主题切换
  - 测试数据管理

- [ ] **数据管理**
  - 查看缓存大小（移动端）
  - 清除缓存
  - 清除数据库
  - 验证清除结果

---

## 🖥️ 响应式布局测试

### 桌面端（≥1024px）

- [ ] 侧边栏导航显示
- [ ] 内容区域布局
- [ ] 用户信息显示
- [ ] 多列布局

### 平板端（600px - 1024px）

- [ ] 侧边栏导航显示
- [ ] 响应式列数
- [ ] 触摸交互

### 移动端（<600px）

- [ ] 底部导航栏
- [ ] 单列布局
- [ ] 触摸交互
- [ ] 滚动性能

---

## 🌐 浏览器兼容性测试

### Chrome/Edge (Chromium)

- [ ] 基本功能正常
- [ ] WebSocket连接
- [ ] 文件下载
- [ ] 剪贴板操作
- [ ] PWA功能

### Firefox

- [ ] 基本功能正常
- [ ] WebSocket连接
- [ ] 文件下载
- [ ] 剪贴板操作
- [ ] PWA功能

### Safari

- [ ] 基本功能正常
- [ ] WebSocket连接
- [ ] 文件下载
- [ ] 剪贴板操作（可能需要HTTPS）
- [ ] PWA功能

### 移动端浏览器

- [ ] Chrome Mobile
- [ ] Safari Mobile
- [ ] Firefox Mobile
- [ ] 触摸交互
- [ ] 响应式布局

---

## 📱 PWA功能测试

### 安装测试

- [ ] 显示"安装"提示
- [ ] 点击安装按钮
- [ ] 验证应用安装
- [ ] 检查主屏幕图标

### 离线功能

- [ ] 断开网络连接
- [ ] 验证缓存内容显示
- [ ] 检查离线提示
- [ ] 测试Service Worker

### 更新测试

- [ ] 修改代码
- [ ] 重新构建
- [ ] 验证自动更新
- [ ] 检查版本提示

---

## ⚡ 性能测试

### 加载性能

- [ ] 首次加载时间 < 3秒
- [ ] 资源加载优化
- [ ] 代码分割
- [ ] 懒加载

### 运行时性能

- [ ] 页面切换流畅
- [ ] 列表滚动流畅
- [ ] 图片加载优化
- [ ] 视频播放流畅

### 内存使用

- [ ] 内存占用合理
- [ ] 无内存泄漏
- [ ] 缓存管理

---

## 🐛 常见问题排查

### 问题1: WebSocket连接失败

**症状**: 无法接收实时消息

**排查步骤**:
1. 检查网络连接
2. 验证Token是否有效
3. 检查WebSocket URL配置
4. 查看浏览器控制台错误

**解决方案**:
- 确保使用HTTPS或localhost
- 检查CORS配置
- 验证Token格式

### 问题2: 文件下载失败

**症状**: 点击下载无反应

**排查步骤**:
1. 检查文件URL是否有效
2. 验证CORS配置
3. 查看浏览器控制台

**解决方案**:
- 确保文件URL可访问
- 配置正确的CORS头
- 使用Blob API下载

### 问题3: 剪贴板操作失败

**症状**: 复制功能不工作

**排查步骤**:
1. 检查是否使用HTTPS
2. 验证浏览器支持
3. 查看控制台错误

**解决方案**:
- 使用HTTPS或localhost
- 使用fallback方法
- 添加用户提示

### 问题4: PWA无法安装

**症状**: 没有安装提示

**排查步骤**:
1. 检查manifest.json
2. 验证图标文件
3. 确保使用HTTPS
4. 检查Service Worker

**解决方案**:
- 创建所有必需的图标
- 配置正确的manifest
- 使用HTTPS部署

---

## 📊 测试报告模板

### 测试环境

- **浏览器**: Chrome 120
- **操作系统**: Windows 11
- **屏幕尺寸**: 1920x1080
- **网络**: WiFi

### 测试结果

| 功能模块 | 状态 | 备注 |
|---------|------|------|
| 认证 | ✅ | 通过 |
| 对话 | ✅ | 通过 |
| 任务 | ✅ | 通过 |
| 剧本 | ⚠️ | 部分功能待优化 |
| 媒体 | ✅ | 通过 |
| 设置 | ✅ | 通过 |

### 发现的问题

1. **问题描述**: ...
   - **严重程度**: 高/中/低
   - **复现步骤**: ...
   - **预期结果**: ...
   - **实际结果**: ...

---

## 🔗 相关文档

- [Web端开发状态](./WEB_IMPLEMENTATION_STATUS.md)
- [Web端平台适配](./WEB_PLATFORM_ADAPTATION.md)
- [Web端工程实施方案](./Web端工程实施方案.md)

---

## 📝 更新日志

### 2026-01-12
- ✅ 创建Web端测试指南
- ✅ 添加功能测试清单
- ✅ 添加浏览器兼容性测试
- ✅ 添加PWA功能测试
- ✅ 添加常见问题排查

---

**文档版本**: v1.0  
**最后更新**: 2026-01-12  
**维护者**: 开发团队
